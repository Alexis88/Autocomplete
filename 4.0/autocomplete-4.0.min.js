"use strict";var autocomplete=function(){return this};autocomplete.prototype={load:function(b){var a=this;this.words=null;this.span=null;this.elem=null;this.xhr=null;this.aux=null;this.cls="highlight";this.container=document.createElement("div");this.source=b.words;this.id=b.id||"dlContainer"+Math.floor(Math.random()*new Date().getTime());this.container.id=this.id;this.container.style.display="none";this.hover=b.optionHover||"gold";this.back=b.backList||"lightyellow";this.container.style.background=this.back||"lightyellow";this.container.style.border=b.borderList||".1rem peru solid";this.container.style.position="absolute";this.container.style.zIndex=9999;this.order=b.order||"anywhere";this.async=b.async||false;this.select=b.select;this.value=b.value;this.data=null;!this.async&&document.addEventListener("readystatechange",function(){if(this.readyState=="complete"){a.ready(b.target)}},false);this.async&&a.ready(b.target)},ready:function(a){document.body.appendChild(this.container);this.apply(a)},ajax:function(b,c){var a=this;a.xhr=new XMLHttpRequest();a.xhr.open("GET",b+(b.indexOf("?")>-1?"&":"?")+"term="+c,true);a.xhr.addEventListener("load",function(){if(this.status==200){a.words=JSON.parse(this.responseText);a.show(a)}},false);a.xhr.send()},show:function(a){a.container.innerHTML="";if(a.words.length){a.words.forEach(function(b){a.span=document.createElement("span");a.span.innerHTML=typeof b!="object"?b:(function(){a.span.dataset.data=JSON.stringify(b);return b[a.value]})();a.span.style.display="block";a.span.style.textAlign="center";a.span.style.cursor="pointer";a.span.style.userSelect="none";a.span.style.WebKitUserSelect="none";a.span.style.MozUserSelect="none";a.span.addEventListener("mouseover",function(){if((a.aux=a.container.querySelectorAll("."+a.cls)).length){a.aux[0].style.background=a.back||"lightyellow";a.aux[0].className=""}this.style.background=a.hover||"gold"},false);a.span.addEventListener("mouseout",function(){this.style.background=a.back||"lightyellow"},false);a.container.appendChild(a.span)});a.container.style.display="block"}},position:function(a){if(a.elem){a.container.style.width=a.elem.offsetWidth+"px";a.container.style.left=a.elem.offsetLeft+"px";a.container.style.top=a.elem.offsetTop+a.elem.offsetHeight+"px"}},write:function(b,a){if(b.length){a.elem=this;a.position(a);if({}.toString.call(a.source)=="[object Array]"){a.words=[];a.source.forEach(function(d){if(d.toLowerCase().search(b.toLowerCase().trim())>-1){switch(a.order){default:if(a.words.indexOf(d)==-1){a.words.push(d)}break;case"first":var c=new RegExp("^"+b,"i");if(c.test(d)){a.words.push(d)}break;case"last":var c=new RegExp(b+"$","i");if(c.test(d)){a.words.push(d)}break}}a.show(a)})}else{if(/(php|asp|jsp|aspx)/gi.test(a.source.substr(a.source.lastIndexOf(".")+1))){a.ajax(a.source,b)}else{a.words=a.source.toLowerCase().search(b.toLowerCase().trim())>-1?[a.source]:[];a.show(a)}}}if(!b.length||(a.words&&!a.words.length)){a.container.style.display="none"}},apply:function(c){var d,a,e,b=this;window.addEventListener("keyup",function(f){if([13,37,38,39,40].indexOf(f.keyCode)==-1){if(f.target.className==c||f.target.id==c||f.target==c){b.write.call(f.target,f.target.value,b)}}else{d=[].slice.call(b.container.querySelectorAll("span"));if(f.keyCode==40){if(b.container.offsetHeight){if(!b.container.querySelectorAll("."+b.cls).length){d[0].className=b.cls;d[0].style.background=b.hover||"gold"}else{a=b.container.querySelector("."+b.cls);e=d.indexOf(a)+1<d.length?d[d.indexOf(a)+1]:d[0];e.className=b.cls;e.style.background=b.hover||"gold";a.className="";a.style.background=b.back||"lightyellow"}}else{if(f.target.value.length&&getComputedStyle(b.container).display=="none"){b.write.call(f.target,f.target.value,b)}}}if(f.keyCode==38){if(b.container.offsetHeight){if(!b.container.querySelectorAll("."+b.cls).length){d[d.length-1].className=b.cls;d[d.length-1].style.background=b.hover||"gold"}else{a=b.container.querySelector("."+b.cls);e=d.indexOf(a)-1>=0?d[d.indexOf(a)-1]:d[d.length-1];e.className=b.cls;e.style.background=b.hover||"gold";a.className="";a.style.background=b.back||"lightyellow"}}}if(f.keyCode==13){if(b.container.offsetHeight){if(a=b.container.querySelector("."+b.cls)){b.elem.value=a.innerHTML;b.container.style.display="none";if(b.select){b.select(JSON.parse(a.getAttribute("data-data")),a,typeof c=="string"?document.querySelector("#"+c)||document.querySelector("."+c):c)}}else{b.container.style.display="none"}}}}},false);window.addEventListener("click",function(){if(event.target.id!=b.id&&event.target.parentNode.id!=b.id){b.container.style.display="none"}if(event.target.parentNode.id==b.id){b.elem.value=event.target.innerHTML;b.container.style.display="none";if(b.select){b.select(JSON.parse(event.target.getAttribute("data-data")),event.target,typeof c=="string"?document.querySelector("#"+c)||document.querySelector("."+c):c)}}},false);window.addEventListener("resize",b.position,false)}};
